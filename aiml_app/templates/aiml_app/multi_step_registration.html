{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AIML 2025 Registration</title>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .step { display: none; }
        .step.active { display: block; }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2>Register for AIML 2025</h2>
    <form id="registrationForm" method="post">
        {% csrf_token %}

        <!-- Step 1: User Info -->
        <div class="step step-1 active">
            <h4>Step 1: Account Info</h4>
            {{ user_form.as_p }}
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <!-- Step 2: Participant Info -->
        <div class="step step-2">
            <h4>Step 2: Personal & Organization Info</h4>
            {{ participant_form.as_p }}
            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="button" class="btn btn-primary next-step">Next</button>
        </div>

        <!-- Step 3: Payment -->
        <div class="step step-3">
            <h4>Step 3: Registration & Payment</h4>
            <div class="mb-3">
                <label for="id_registration_type">Registration Type</label>
                <select id="id_registration_type" name="registration_type" class="form-control">
                    {% for value, label in participant_form.fields.registration_type.choices %}
                        <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label>Registration Fee</label>
                <input type="text" id="registration_fee" readonly class="form-control">
            </div>

            <div class="mb-3">
                <label for="id_payment_option">Payment Option</label>
                {{ participant_form.payment_option }}
            </div>

            <div class="mb-3">
                <label>Card Number</label>
                {{ participant_form.card_number }}
            </div>
            <div class="mb-3">
                <label>Expiry Date (MM/YY)</label>
                {{ participant_form.expiry_date }}
            </div>
            <div class="mb-3">
                <label>CVV</label>
                {{ participant_form.cvv }}
            </div>

            <button type="button" class="btn btn-secondary prev-step">Back</button>
            <button type="submit" class="btn btn-success">Submit</button>
        </div>
    </form>
</div>

<script>
const registrationPrices = {
    'student_early': 50,
    'student_late': 70,
    'academic_early': 100,
    'academic_late': 130,
    'industry_early': 200,
    'industry_late': 250
};

$(document).ready(function() {
    // Step navigation
    $('.next-step').click(function() {
        let current = $(this).closest('.step');
        current.removeClass('active').next('.step').addClass('active');
    });

    $('.prev-step').click(function() {
        let current = $(this).closest('.step');
        current.removeClass('active').prev('.step').addClass('active');
    });

    // Dynamic registration fee display
    $('#id_registration_type').change(function() {
        const selected = $(this).val();
        $('#registration_fee').val(registrationPrices[selected]);
    });

    // Initialize fee on load
    $('#id_registration_type').trigger('change');
});
</script>
</body>
</html>
