{% extends "aiml_app/base.html" %}
{% block content %}
<h2>Step 3: Registration & Payment</h2>
<form method="post">{% csrf_token %}
  {{ wizard.management_form }}
  <div>
    {{ wizard.form.registration_type.label_tag }}
    {{ wizard.form.registration_type }}
  </div>

  <div>
    <strong>Registration Fee: </strong>
    <span id="registration_fee_display">
      {{ wizard.form.registration_fee.value|default:"0.00" }}
    </span> USD
  </div>

  <div>
    {{ wizard.form.payment_option.label_tag }}
    {{ wizard.form.payment_option }}
  </div>
  <div>
    {{ wizard.form.card_number.label_tag }}
    {{ wizard.form.card_number }}
  </div>
  <div>
    {{ wizard.form.expiry_date.label_tag }}
    {{ wizard.form.expiry_date }}
  </div>
  <div>
    {{ wizard.form.cvv.label_tag }}
    {{ wizard.form.cvv }}
  </div>

  <button type="submit">Finish</button>
</form>

<script>
  const registrationPrices = {
    "student_early": 50,
    "student_late": 70,
    "academic_early": 100,
    "academic_late": 130,
    "industry_early": 200,
    "industry_late": 250
  };

  const regSelect = document.getElementById("id_registration_type");
  const feeDisplay = document.getElementById("registration_fee_display");

  function updateFee() {
    const selected = regSelect.value;
    feeDisplay.textContent = registrationPrices[selected] || "0.00";
  }

  regSelect.addEventListener("change", updateFee);

  // initialize on page load
  updateFee();
</script>
{% endblock %}
